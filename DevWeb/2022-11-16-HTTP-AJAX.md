> <span style="font-size: 1.5em">üìñ</span> <span style="color: orange; font-size: 1.3em;">Pr√©sentation [Chapitre 6 : HTTP et Ajax](https://he-arc.github.io/slides-devweb/06-HTTPandAJAX.html)</span>


# HTTP
HyperText Transfer Protocol

Invent√© en Suisse, au CERN

Protocole de niveau 7
- de type texte
- non connect√© : aucune info sur le client
- Cycle de vie : √©change requ√™te/r√©ponse

Contenu :
- Texte
- Binaire (depuis HTTP2)
> Encodage du binaires en texte : Base64 (prend 50% de place en plus qu'un binaire pure)

Ent√™tes aussi bien dans les requ√™tes que dans les r√©ponses


Verbes HTTP principaux :
- GET
- POST
- PUT/PATCH
- DELETE
- HEAD

Requ√™te : Verbe + URI

Que s√©pare l'ent√™te du corps : une ligne vide (2 retour √† la ligne)


## Ent√™te de requ√™te
- Host : Obligatoire (car on h√©berge plusieurs adresse sur un m√™me serveur)
  - Permet d'atteindre le bon service
- Referer : Adresse de la page qui a fait la requ√™te (si on tape dans l'URL, valeur vide)
- User-Agent : Navigateur utilis√©

## Ent√™te de r√©ponse
- Content-Type : Type de contenu (JSON, image, etc)
  - Pour que le navigateur sache comment traiter/parser le contenu
  - Syntaxe MIME : image/jpeg, text/html, application/json, etc
- Set-Cookie : Conteneur
  - Qui a acc√®s : limit√© au domaine qui les a cr√©√©
- Location : Redirection


## Codes de r√©ponses
- 1xx : Information
- 2xx : Succ√®s
- 3xx : Redirection
  - 301 : Moved Permanently
  - 302 : Found
  - Exemple : 301 : abc.ch -> abc.com
- 4xx : Erreur client
- 5xx : Erreur serveur
  - Provoqu√© par un fichier qui fait planter le serveur avant le renvoie de la vue
  - Bonne pratique : si on voie une erreur 500, regarder les logs Laravel

## Verbes
Verbe | Description
--- | ---
<span style="color: blue">GET</span> | Demander une ressource
POST | Cr√©ation d‚Äôune ressource
<span style="color: magenta">PUT</span> | Remplacement total d‚Äôune ressource
PATCH | Remplacement partiel d‚Äôune ressource
<span style="color: magenta">DELETE</span> | Suppression d‚Äôune ressource
<span style="color: blue">HEAD</span> | Demande l‚Äôent√™te de la r√©ponse, sans la ressource
> Put/Patch  : Non li√© √† la BDD (exemple ID/autre), mais plut√¥t au contenu modifi√© (exemple une donn√©e blob : `put` on remplace tout, `patch` on r√©cup√®re que les donn√©es modifi√©es, et on les mets √† jour).
> En soit, le patch consiste √† un pr√©-traitement sur les donn√©es, alors que `put` ne fait que remplacer les donn√©es demand√©es.

Autres verbes : <span style="color: blue">TRACE</span>, <span style="color: blue">OPTIONS</span>, CONNECT

> Put : r√©√©crit tout les attributs (m√™me s'il ne changent pas)
> Patch : r√©√©crit seulement les attributs qui ont chang√©

<span style="color: blue">S√ªres</span> : ne modifie pas l'√©tat du serveur
<span style="color: magenta">Idempotentes</span> : Le syst√®me change d'√©tat la premi√®re fois, puis reste dans le nouvel √©tat les fois suivantes
> Un verbe s√ªre est idempotent, mais pas l'inverse

> Attention √† conserver que des actions "s√ªres" dans celles sp√©cifi√©es.
> Car par exemple les bots de Google vont essayer tous les liens GET du site, et donc executer l'action.
> Si par exemple l'action GET permet de vider la table des utilisateurs, l'action sera execut√©e --> <span style="color: red">probl√®me</span>


## Exemple d'√©change

![](Screen/2022-11-16-13-33-38.png)

requ√™te GET : les arguments sont dans l'URL
requ√™te POST : les arguments viennent dans le corps de la requ√™te

---
---

XHR : XML Http Request
![](Screen/2022-11-30-13-08-20.png)

# JSON

Pourquoi JSON est populaire
- JS Object Notation
- Car c'est lit√©rallement un objet JS, donc d√©j√† s√©rialis√©

**S√©rialiser/d√©s√©rialiser :**
  ![](Screen/2022-11-30-13-16-14.png)
- Eval :
  - Interpr√®te une cha√Æne de caract√®re comme du code JS
  - Ne pas utiliser pour importer un objet JSON, car permet d'executer n'importe quel code JS
- Parse :
  - Convertir un texte en objet JS
Stringify :
  - Convertir un objet JS en texte